<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Snake Game</title>
  <style>
    :root{--bg:#0f1724;--panel:#0b1220;--accent:#10b981;--muted:#94a3b8;--danger:#ef4444}
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#071126 0%, #071935 100%);color:#e6eef8}
    .wrap{width:min(900px,96vw);display:grid;grid-template-columns:1fr 320px;gap:18px;padding:22px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border-radius:12px;padding:14px;box-shadow:0 6px 20px rgba(2,6,23,0.6);}
    header{display:flex;align-items:center;gap:12px;margin-bottom:10px}
    h1{font-size:18px;margin:0}

    /* canvas area */
    .game-area{display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#07122a, #031025);border-radius:8px;padding:14px}
    canvas{background:#071024;border-radius:6px;display:block;width:100%;height:auto;max-width:560px}

    /* sidebar */
    .sidebar{display:flex;flex-direction:column;gap:12px}
    .panel{padding:12px;border-radius:8px;background:rgba(255,255,255,0.02)}
    .stat{display:flex;justify-content:space-between;align-items:center;font-weight:600}
    .controls{display:flex;flex-direction:column;gap:8px}
    button{border:0;background:var(--accent);color:#042017;padding:8px 12px;border-radius:8px;font-weight:700;cursor:pointer}
    button.secondary{background:transparent;color:var(--accent);border:1px solid rgba(255,255,255,0.06)}
    small{color:var(--muted)}

    /* simple mobile controls */
    .dpad{display:grid;grid-template-columns:repeat(3,56px);grid-template-rows:repeat(3,56px);gap:6px;justify-content:center}
    .btn-pad{display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02);border-radius:8px;cursor:pointer;user-select:none}
    .btn-pad.active{background:rgba(255,255,255,0.06)}

    footer{grid-column:1/-1;text-align:center;color:var(--muted);font-size:13px;margin-top:6px}

    @media (max-width:880px){.wrap{grid-template-columns:1fr;}.sidebar{order:2}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='34' height='34'><rect rx='6' width='34' height='34' fill='%2310b981'/></svg>" alt="logo" width="34" height="34">
        <div>
          <h1>Snake — simple HTML game</h1>
          <small>Use arrow keys or WASD. Tap buttons on mobile.</small>
        </div>
      </header>

      <div class="game-area">
        <canvas id="game" width="480" height="480"></canvas>
      </div>

      <footer>
        Tip: Press <strong>Space</strong> to pause / resume. Refresh to reset fully.
      </footer>
    </div>

    <aside class="sidebar">
      <div class="panel card">
        <div class="stat"><span>Score</span><span id="score">0</span></div>
        <div style="height:10px"></div>
        <div class="stat"><span>Speed</span><span id="speedLabel">6</span></div>
        <div style="height:10px"></div>
        <div class="stat"><span>Grid</span><span id="gridSize">20×20</span></div>
      </div>

      <div class="panel card">
        <div class="controls">
          <label>
            <small>Game speed (frames/sec)</small>
            <input id="speed" type="range" min="4" max="16" value="6">
          </label>
          <label>
            <small>Grid size (cells per row)</small>
            <input id="grid" type="range" min="10" max="32" value="20">
          </label>

          <div style="display:flex;gap:8px;margin-top:6px">
            <button id="start">Start / Restart</button>
            <button id="pause" class="secondary">Pause</button>
          </div>
        </div>
      </div>

      <div class="panel card">
        <small>Mobile controls</small>
        <div style="height:8px"></div>
        <div class="dpad" id="dpad">
          <div></div>
          <div class="btn-pad" data-dir="up">▲</div>
          <div></div>
          <div class="btn-pad" data-dir="left">◀</div>
          <div class="btn-pad" data-dir="down">▼</div>
          <div class="btn-pad" data-dir="right">▶</div>
          <div></div>
          <div></div>
          <div></div>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // Simple snake game — single file
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    let gridCount = 20;
    let speed = 6; // frames per second
    let cellSize = Math.floor(canvas.width / gridCount);

    const scoreEl = document.getElementById('score');
    const speedEl = document.getElementById('speed');
    const speedLabel = document.getElementById('speedLabel');
    const gridEl = document.getElementById('grid');
    const gridLabel = document.getElementById('gridSize');

    let snake = [{x:9,y:9}];
    let dir = {x:0,y:0};
    let apple = {x:5,y:5};
    let score = 0;
    let lastTime = 0;
    let paused = true;

    function reset(){
      gridCount = parseInt(gridEl.value,10);
      speed = parseInt(speedEl.value,10);
      cellSize = Math.floor(canvas.width / gridCount);
      snake = [{x:Math.floor(gridCount/2), y:Math.floor(gridCount/2)}];
      dir = {x:0,y:0};
      apple = randomCell();
      score = 0;
      paused = true;
      updateUI();
      draw();
    }

    function randomCell(){
      let cell;
      do {
        cell = {x: Math.floor(Math.random()*gridCount), y: Math.floor(Math.random()*gridCount)};
      } while(snake.some(s => s.x===cell.x && s.y===cell.y));
      return cell;
    }

    function updateUI(){
      scoreEl.textContent = score;
      speedLabel.textContent = speed;
      gridLabel.textContent = gridCount + '×' + gridCount;
    }

    function draw(){
      // background
      ctx.fillStyle = '#071024';
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // grid (subtle)
      ctx.strokeStyle = 'rgba(255,255,255,0.02)';
      ctx.lineWidth = 1;
      for(let i=0;i<=gridCount;i++){
        const pos = i*cellSize;
        ctx.beginPath(); ctx.moveTo(pos,0); ctx.lineTo(pos,canvas.height); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(0,pos); ctx.lineTo(canvas.width,pos); ctx.stroke();
      }

      // apple
      drawCell(apple.x, apple.y, '#ef4444', true);

      // snake
      for(let i=0;i<snake.length;i++){
        const s = snake[i];
        const bright = i===0 ? true : false;
        drawCell(s.x, s.y, bright ? '#10b981' : '#0ea5a9', bright);
      }
    }

    function drawCell(x,y,color,glow){
      const px = x*cellSize;
      const py = y*cellSize;
      if(glow){
        ctx.shadowColor = color;
        ctx.shadowBlur = 12;
      } else { ctx.shadowBlur = 0; }
      ctx.fillStyle = color;
      const pad = Math.max(2, Math.floor(cellSize*0.08));
      ctx.fillRect(px+pad, py+pad, cellSize-pad*2, cellSize-pad*2);
      ctx.shadowBlur = 0;
    }

    function gameStep(){
      // move snake
      if(dir.x===0 && dir.y===0) return; // not started
      const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};

      // wrap around edges
      head.x = (head.x + gridCount) % gridCount;
      head.y = (head.y + gridCount) % gridCount;

      // collision with self
      if(snake.some(s => s.x===head.x && s.y===head.y)){
        // game over — simple restart prompt
        paused = true;
        alert('Game over! Score: ' + score);
        reset();
        return;
      }

      snake.unshift(head);

      // apple eaten
      if(head.x===apple.x && head.y===apple.y){
        score += 1;
        apple = randomCell();
      } else {
        snake.pop();
      }

      updateUI();
      draw();
    }

    function loop(timestamp){
      if(!lastTime) lastTime = timestamp;
      const msPerFrame = 1000 / speed;
      if(!paused){
        if(timestamp - lastTime >= msPerFrame){
          lastTime = timestamp;
          gameStep();
        }
      }
      requestAnimationFrame(loop);
    }

    // input handlers
    window.addEventListener('keydown', e => {
      if(e.key === ' '){ paused = !paused; document.getElementById('pause').textContent = paused ? 'Resume' : 'Pause'; }
      const k = e.key.toLowerCase();
      if(k === 'arrowup' || k === 'w') setDir(0,-1);
      if(k === 'arrowdown' || k === 's') setDir(0,1);
      if(k === 'arrowleft' || k === 'a') setDir(-1,0);
      if(k === 'arrowright' || k === 'd') setDir(1,0);
    });

    function setDir(x,y){
      // prevent reversing into self
      if(snake.length > 1){
        if(dir.x === -x && dir.y === -y) return;
      }
      dir = {x,y};
      paused = false;
      document.getElementById('pause').textContent = 'Pause';
    }

    document.getElementById('start').addEventListener('click', ()=>{
      reset();
      paused = false;
      document.getElementById('pause').textContent = 'Pause';
    });
    document.getElementById('pause').addEventListener('click', ()=>{
      paused = !paused;
      document.getElementById('pause').textContent = paused ? 'Resume' : 'Pause';
    });

    speedEl.addEventListener('input', ()=>{ speed = parseInt(speedEl.value,10); speedLabel.textContent = speed; });
    gridEl.addEventListener('input', ()=>{ gridCount = parseInt(gridEl.value,10); gridLabel.textContent = gridCount + '×' + gridCount; cellSize = Math.floor(canvas.width / gridCount); reset(); });

    // mobile dpad
    document.querySelectorAll('.btn-pad').forEach(b => {
      b.addEventListener('touchstart', e => { e.preventDefault(); b.classList.add('active'); handlePad(b.dataset.dir); });
      b.addEventListener('touchend', e => { b.classList.remove('active'); });
      b.addEventListener('mousedown', e => { b.classList.add('active'); handlePad(b.dataset.dir); });
      b.addEventListener('mouseup', e => { b.classList.remove('active'); });
    });

    function handlePad(dirName){
      if(!dirName) return;
      if(dirName === 'up') setDir(0,-1);
      if(dirName === 'down') setDir(0,1);
      if(dirName === 'left') setDir(-1,0);
      if(dirName === 'right') setDir(1,0);
    }

    // initialize
    reset();
    requestAnimationFrame(loop);

    // make canvas crisp on high-dpi screens
    function resizeCanvas(){
      const ratio = Math.min(window.devicePixelRatio || 1, 2);
      const size = 480; // base size
      canvas.width = size * ratio;
      canvas.height = size * ratio;
      canvas.style.width = '100%';
      canvas.style.height = 'auto';
      ctx.setTransform(ratio,0,0,ratio,0,0);
      cellSize = Math.floor((canvas.width/ratio) / gridCount);
      draw();
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
  </script>
</body>
</html>
